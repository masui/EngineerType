<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>IoT時代の認証技法</title>
</head>
<body>

<div style="width:500pt">

<h1>世界の不便を退治しよう(5) - IoT時代の認証技法</h2>

先日ロンドンを訪問したときGoogleMapsでホテルの地図を検索したら、
「お前は今日このホテルに宿泊することになっている」
と地図上に表示されたのでとても驚きました。
私は普通の検索と地図以外のGoogleサービスを使っていませんし、
もちろんGoogle経由でホテルを予約したわけでもないので、
何故自分の情報がGoogleに知られているのかとても不思議に思いました。
私は普段GMailを使ってはいないのですが、
念のためにすべてのメールをGMailアカウントに転送しているので、
その内容から判定されたのかもしれません。
いずれにしても気持ちが悪かったのは確かです。
現状でもこの有様ですから、
センサやコンピュータがあらゆるところに存在して行動がモニタされるIoT時代には
このようなプライバシを守ることはとても難しいでしょう。

<!--
あらゆるところでデータを取得されるIoT時代にはプライバシを守るのは大変
あらゆる行動がモニタされてしまうとプライバシもヘッタクレもない
-->

<p>
一方、IoT時代には認証手法が現在よりも重要になってくると思われます。

現状では、
Webサービスのような特定のサービスを使うときに
パスワードなどを利用してそのサービスに対する認証を行なうのが普通ですが、
IoT時代には、
あらゆる場所で無意識的に様々なサービスを利用することが増えてきますから、
いちいちパスワードを入力してはいられないでしょう。

自動的に、良い具合で認証が行なわれることを期待しなければなりません。

<br>
パスワードによる認証はいろいろな問題があるため、
それに変わる新しい認証手法が提案されていますが、
驚いたことに(?)
あらゆる面でパスワードよりも優れた認証手法は存在しないようです。

あちこちで認証が必要になっている

パスワードを使うのが一般的

パスワードは問題だが仕方がないところもある

現在スタンフォード大学でセキュリティの研究をしている
<a href="http://jbonneau.com/">Joseph Bonneau氏</a>の
<a href="http://research-srv.microsoft.com/pubs/161585/QuestToReplacePasswords.pdf">調査</a>[1]によれば、
これまで提案されているどの認証手法にも欠点があり、
パスワードを越える手法はすぐには期待できないようです。

<blockquote>
<a href="http://research-srv.microsoft.com/pubs/161585/QuestToReplacePasswords.pdf">
<img src="https://gyazo.com/ce29c9d65b04a8ba60446a02fc9ced4d.png"><br>
</a>
パスワード認証と他の認証手法の比較: あらゆる点でパスワードを越える認証手法が存在しない.
</blockquote>

<p>
プライバシを守るのは大変だし認証の手間も大変だというのでは
IoT時代はお先真っ暗という雰囲気がありますが、
これらをうまく組み合わせると解決する可能性があります。

IoTデバイスによって自分の行動履歴がずっと記録されていれば、
プライバシ的には問題があるかもしれませんが
自分の行動をもとにした認証システムを利用できる可能性が高くなります。

<行動履歴をもとにした認証の論文>

自分の詳細行動がどこかに記録されているなら、
他人がそれと同じ行動をとることは不可能なわけで、
その行動を認証手段に使えば他人に真似されることがありえない

このような無意識な行動にもとづく認証は
パスワードに比べると全然安全かもしれません。

自分の行動履歴の多くはSuicaに記録されているわけですが、
ある行動パタンが記録されているSuicaでのみ認証が成功するようなシステムを
用意しておけば、それなりに安全な認証を行なうことができるでしょう。

特別なところに行ったことを記録しておき、
その情報が無いと認証に成功しないようにしておけばさらに安全かもしれません。

どういう場所を通ってきたかを記録していれば、それをもとにして認証できる

最近は
2段階認証/2要素認証
というような、複数の方法で認証を行なうのが一般的になってきていますが、
様々なIoT的センサ情報を認証に利用することには意義がありそうです。

<h2>FIDO</h2>

パスワード認証の問題を解決する、
IoT時代の認証のために
2012に<a href="https://fidoalliance.org/">FIDO Alliance</a>
という業界団体が発足しています。

「Fido」という認証の枠組を提案しています。

FIDOは
PayPalの人がはじめたものですが、現在は沢山のメンバを集めています。

Allianceは2012に発足
  PayPal, Lenovo, Nok Nok Labs, Validity Sensors, Infineon, and Agnitio
  
主に生体認証(バイオメトリクス)を使う (たぶん)
ローカルに認証する (サーバにパスワードをおかない)

たとえば
PassBanという会社は、
顔や声などの生体認証、ジェスチャー、ジオロケーションなど様々な
<a href="http://cloud.watch.impress.co.jp/docs/interview/20150813_716045.html">認証方法を12種類用意してユーザーが好きな方法で認証できるソリューションを提供していました</a>が、

PassBanでは、ユーザー認証がもっと便利で簡単になることを目的に、パスワー
ドの代わりになるものを探していました。特にタブレットやスマートフォンで
複雑なパスワードを入力するのは面倒ですからね。そこでPassBanでは、認証
方法を12種類用意し、ユーザーが好きな方法で認証できるソリューションを提
供したのです。その認証方法とは、顔や声などの生体認証から、ジェスチャー、
ジオロケーションなどさまざまです。また、RSAトークンもサポートし、ワン
タイムパスワードも利用できるようにしていました。

RSAに買収されたのは、創業して約1年半後の2013年7月


PassBanを買収したRSAはFIDOアライアンスに参加しており、
現在はMicrosoft、Google、Intel、PayPal、NTTドコモなど、さまざまな大手企業が加入しています。

https://www.nttdocomo.co.jp/info/news_release/
ドコモが入った
> NTTドコモ（以下、ドコモ）は、パスワードレスなオンライン認証のための技
> 術仕様の標準化を提唱する国際的な非営利団体「FIDO Alliance」に、2015年5
> 月26日（火曜）から、ボードメンバーとして加入いたします。

https://www.nttdocomo.co.jp/info/news_release/2015/05/26_00.html
FIDO解説?

すでにFIDOベースのソリューションも登場しています。勢いもあります
し、今後FIDOは重要な認証方法のひとつとなるでしょう。

http://cloud.watch.impress.co.jp/docs/interview/20150813_716045.html


***現在のパスワードベースの認証の仕組みは、ユーザーが入力したパスワード
がサーバーに送られ、サーバー上でパスワードを照合するようになっています。
さまざまなサーバーが不正アクセスされていることを考えると、これは大きな
問題です。攻撃者にとっては、山のような数の認証情報がサーバーというひと
つの便利な場所に集約されていることになるのですから。
<br>
***一方FIDOは、デバイスの信頼性で認証する仕組みで、認証情報はサーバーで
はなくデバイス側にあります。つまり、デバイスとユーザーの間で認証がとれ
ると、デバイスがサーバーに対してこのユーザーはアクセスを許可できる人物
だと伝えるのです。その際、サーバーに認証情報が送られることはありません。
信頼されたデバイスが適切なユーザーであることを認証したという前提で、ア
クセスを許可するのです。
<br>
***この手法だと、攻撃者がサーバーを攻撃しても、サーバーには認証情報が存
在しないため被害は限定的です。これまでは1億のパスワードを盗もうと思え
ば1億個のパスワードが詰まったサーバーを狙って攻撃すればよかったのが、
これからは1億個のパスワードを盗むには1億個のデバイスを物理的に盗まなく
てはいけなくなるのです。また、ユーザー側にしても、デバイスは個人が所有
しているものですから、認証情報をサーバーに送る必要がないことでプライバ
シーを保てます。ユーザーが利用するサービスは、デバイスを介してのみユー
ザーとつながりを持てることになるのです。

<h3>FIDOのプロトコル</h3>

http://app-review.jp/news/230600
* UAF

まずは UAF についてだが、Nok Nok Labs の Rolf Lindemann 氏によれば、デ
バイスに自分を認証させる情報を登録し、そのデバイスをオンラインサーバで
登録する、という仕組みだ。

このプロトコルの最大のポイントは、認証を個人の認証とデバイスの認証に分
解したという点だ。

現状では、インターネットを通してパスワードで認証を行っているが、この認
証を
  デバイスによる個人の認証と
  オンラインサーバによるデバイスの認証
に分解したことで、個人認証に用いる情報がインターネットを経由することがなく
なる。つまり、ネットから個人の認証情報が流出する可能性が無くなるのだ。

パスワードからの脱却も FIDO Alliance の大きなテーマであるため、生体認
証に対応したデバイスを用いて個人認証は生体情報で行うことを基本としてい
る。 (本当?)

FIDOはDec. 9, 2014に
UAF, U2Fという
2種類の認証プロトコルを規定しています。

UAFは将来の理想の認証を目指したプロトコルで、
認証に必要な情報を手持ちのデバイスに登録しておき、
その装置で認証を行なった後でサーバと通信を行なうことによって
認証を行なうというものです。
手持ちデバイスを使った認証は
生体認証など任意の手法を利用できます。
手元のデバイスを利用した個人認証と
サーバとデバイスとの通信によるデバイス認証を組み合わせることにより
パスワードのような重要情報をサーバに記憶する必要が無くなり、
ネットから個人情報が流出する心配がありません。

一方、U2Fは
UAFが普及するまで一時的に利用することを考えたもので、
パスワード認証を利用する現状サービスの上に使いやすい2段階認証を導入したものです。
http://app-review.jp/news/230600

<!--
一方 U2F だが、Google の Dirk Balfanz 氏によれば、現行のオンライン認証
に USB メモリなどの第2要素による認証を追加した2段階認証である。

これは要するに、Googleアカウントで言えば、ID（Gmailアドレス）＆パスワー
ドの他に電話番号も登録し、Google 管理コンソールから有効にすれば利用す
ることができる2段階認証を改善したようなものである。現状の2要素認証は、
ユーザー側から見れば非常に手間のかかる、面倒くさい方式であり、Google
の Sam Srinivas 氏によれば2段階認証を利用しているユーザーはあまり多く
ないという。また、ワンタイムパスワードを生成するような機器は壊れやすかっ
たり、高価であるという問題もある。

そこで、FIDO では、安価に作れる USB メモリのようなデバイスを挿すだけで
できるような、UX（ユーザーエクスペリエンス）を改善した2要素認証として
U2F を提案している。また、この U2F では、2要素目のキーとして用いている
デバイスから公開鍵と秘密鍵のペアを生成し、その公開鍵を事前にサーバに登
録する方式をとっている。認証の際には USB キーから生成した秘密鍵でサイ
ンした情報を、サーバに事前登録された鍵と照合して認証する。

このため、悪意を持った偽のサーバにアクセスしてしまったとしても、偽のサー
バがそこから認証のキーを得て本来のサーバにアクセスすることはできない仕
組みだ。接続先のサイトに登録した認証デバイス（オーセンティケータ）と認
証要素が揃って初めて認証できる仕組みであることから、フィッシングや「な
りすまし」対策が可能となる。
-->

FIDO を実現する認証方式を2つ開発した理由については、現在の認証を全て
UAF へ移行するまでの間、一部の認証を U2F で行う必要があるからだということです。

2要素目のキーとして用いているデバイスから公開鍵と秘密鍵のペアを生成し、
その公開鍵を事前にサーバに登録する方式をとっている

<h2>IoT時代の認証の今後</h2>

プライバシ、認証、などをうまく組み合わせた設計が必要になるのだろう

FIDOが標準になるかはわかりませんが、
IoT技術をうまく利用した認証手法が将来広く使われるようになることは間違いないでしょう。


手の中にRFIDを埋め込んで認証を行なうという恐い話が
<a href="http://fundo.jp/20664">話題になっていました</a>。

<!--
”エピセンター”というスウェーデンの複合オフィスでは、マイクロチップを
社員の手に埋め込むという試みが、実際に行われています。手をかざすだけで
携帯電話のロック解除や、オフィスへの入室が可能に。まるでSF映画みたいで
す。
更新日: 2015年09月17日
http://matome.naver.jp/odai/2142378307666546901

http://karapaia.livedoor.biz/archives/52184120.html

カスペルスキー? スウェーデン??
http://blog.livedoor.jp/itsoku/archives/46175853.html
-->

<blockquote>
<img src="https://gyazo.com/8632086ca5ed8281be55a178e1a342b6.png">
</blockquote>

指に埋め込むのは嫌でしょうが、
いつも持ち歩いているスマホで認証を行なったり
生体認証を行なったりするのであれば
そう変わらないともいえるでしょう。

プライバシが漏れまくる地獄になるのか、
認証がほとんど不要になる天国になるのか
頑張りが必要なのでしょう。

<p>
[1] Joseph Bonneau, Cormac Herley, Paul C. van Oorschot and Frank Stajano.
The Quest to Replace Passwords: A Framework for Comparative Evaluation of Web Authentication Schemes.
Proceedings of the 2012 IEEE Symposium on Security and Privacy, pp. 553-567, 2012.

</div>
</body>
</html>

