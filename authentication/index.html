<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>IoT時代の認証技法</title>
</head>
<body>

<div style="width:500pt">

<h1>世界の不便を退治しよう(5) - IoT時代の認証技法</h2>

先日ロンドンを訪問したときGoogleMapsでホテルの地図を検索したら、
「お前は今日ここのホテルに宿泊することになっている」と地図上に表示されたので驚きました。
私は普通の検索と地図以外のGoogleサービスを使っていませんし、
もちろんGoogle経由でホテルを予約したわけでもないので、
何故自分の情報がGoogleに知られているのかとても不思議に思ったわけです。
私は普段GMailを使ってはいないのですが、
念のためにすべてのメールをGMailアカウントに転送しているので
その内容から判定されたのかもしれません。
他の理由によるのかもしれませんが、
思わぬところで個人情報が漏れてる様に感じられて気持ちが悪かったのは確かです。
現状でもこの有様ですから、
センサやコンピュータがあらゆるところに存在して行動がモニタされるIoT時代には
完全にプライバシを守ることは難しいでしょう。

<p>
一方、IoT時代には認証手法が現在よりも重要になってくると思われます。

現状のWebサービスではパスワードで認証を行なうのが普通ですが、
あらゆる場所で無意識的に様々なサービスを利用することが増えてくるIoT時代には
サービスを利用するたびにパスワードを入力するわけにはいきませんから、
うまい具合に自動的に適切な認証が行なわれることを期待しなければなりません。

<p>
現在広く利用されているパスワード認証は、
強力なパスワードを覚えるのが大変なうえに攻撃に弱いという欠点があるため、
パスワードに変わる新しい認証手法がこれまで沢山提案されていますが、
あらゆる面でパスワードよりも優れた認証手法はまだ存在しないようです。

現在スタンフォード大学でセキュリティの研究をしている
<a href="http://jbonneau.com/">Joseph Bonneau氏</a>の
<a href="http://research-srv.microsoft.com/pubs/161585/QuestToReplacePasswords.pdf">調査</a>[1]によれば、
これまで提案されているどの認証手法もなんらかの欠点があるということなので、
パスワードを完全に置き換えられる手法はすぐには期待できないようです。

<blockquote>
<a href="http://research-srv.microsoft.com/pubs/161585/QuestToReplacePasswords.pdf">
<img src="https://gyazo.com/ce29c9d65b04a8ba60446a02fc9ced4d.png" width=500><br>
</a>
パスワード認証と他の認証手法の比較: あらゆる点でパスワードを越える認証手法が存在しない.
</blockquote>

プライバシを守るのは大変だし認証の手間も大変だというのでは
IoT時代はお先真っ暗という雰囲気がありますが、
これらを組み合わせることにより便利になることもあります。

<h2>プライバシと認証の組み合わせ</h2>

IoTデバイスによって自分の行動履歴がずっと記録されていれば、
プライバシ的に多少の心配があるかもしれませんが、
行動履歴をもとにした認証システムを利用できる可能性が高くなります。

<!--
http://www.sict.i.u-tokyo.ac.jp/news/sympo20150612/yamaguchi20150612.pdf
複数行動履歴などによる認証
-->

パスワードのような単一の情報を認証に利用する方法は
充分安全だと考えられなくなってきたので、
最近は2段階認証/2要素認証というような
複数の方法で認証を行なうのが一般的になってきていますが、
様々なIoT的センサで取得した個人情報を認証に利用すれば
苦労することなく認証強度を上げることが可能になるはずです。

自分の行動の詳細がどこかに記録されており、
他人がそれと同じ行動をとることが難しい場合、
行動の履歴や記憶を認証に利用することができます。

たとえば電車やバスによる移動の履歴はSuicaのような交通系カードに記録されますが、
普通のユーザが内容を書き換えることはできないので、
特定の行動パタンが記録されているSuicaでのみ認証が成功するようなシステムを用意すれば
それなりに安全な認証を行なうことができるでしょう。

ロンドンのホテルに宿泊したといった個人的な情報を沢山利用して多段階認証を行なうことにより
さらに認証の強度を上げることができます。

このような方法では、
頑張って秘密の情報を記憶する必要がありませんし、
特殊な装置を持ち歩く必要もないので、
気楽で安全だといえるでしょう。

<h2>FIDO</h2>

パスワード認証の問題を解決し、
IoT時代の新しい認証手法を普及させるため、
2012に<a href="https://fidoalliance.org/">FIDO Alliance</a>
という業界団体が発足しています。

FIDO Allianceは、
PayPalのセキュリティ責任者だったMichael Barrettが中心となって
PayPal, Lenovo, Nok Nok Labs, Validity Sensors, Infineon, Agnitio
などにより設立されたもので、
現在はMicrosoft、Google、Intel、<a href="https://www.nttdocomo.co.jp/info/news_release/2015/05/26_00.html">NTTドコモ</a>、RSAなど、
多くの大手企業が加入しています。

<p>
一般的なパスワード認証の場合、
ユーザIDやパスワードの正当性はサーバで判断されるため
あらゆる認証情報がサーバに蓄積されており、
常に情報流出の危険がともないますし、
実際多くの事故が発生していますが、

FIDOの方式ではユーザの端末で認証を行ない、
その後サーバと端末が通信することによってサービスへのアクセスを許可します。

このため情報流出の危険が減りますし、
パスワード以外の様々な認証手法を端末で利用することが可能になっています。

端末での認証手法としては主に生体認証(バイオメトリクス)が想定されていますが、
前述のようなIoTベースの様々な個人情報を利用することも可能です。

顔、声、ジェスチャー、位置情報など様々な情報を認証に利用するシステムを
<a href="http://cloud.watch.impress.co.jp/docs/interview/20150813_716045.html">提供していた</a>
PassBanという会社が2013年にRSAに買収されました。
RSAはFIDO Allianceのメンバになっているため、
このような認証技術がFIDOに利用されるようになると考えられます。

<h3>FIDOのプロトコル</h3>

FIDOは2014年12月にUAF, U2Fという2種類の認証プロトコルを<a href="http://app-review.jp/news/230600">規定しました</a>。
現在主流のパスワード認証をすべていきなりFIDO対応させることは不可能ですから、
段階的に理想的な状態に近付けていこうと考えているようです。

<ul>
<li><b>UA</b>F</li>

UAF(Universal Authentication Framework)は
将来における理想的な認証を目指したプロトコルで、
認証に必要な情報を手持ちのデバイスに登録しておき、
その装置で認証を行なった後でサーバと通信を行なうことによって認証を行なうというものです。
手持ちデバイスを使った認証は
生体認証など任意の手法を利用できます。
手元のデバイスを利用した個人認証と
サーバとデバイスとの通信によるデバイス認証を組み合わせることにより
パスワードのような重要情報をサーバに記憶する必要が無くなり、
ネットから個人情報が流出する心配がありません。

<li><b>U2F</b></li>

U2F(Universal Second Factor)はUAFが普及するまでのつなぎとして考えられたプロトコルで、
現在一般的なパスワード認証の上に2段階認証を導入したものです。
ユーザはIDとパスワードで認証を行なった後、
U2Fに対応したUSBメモリやNFC装置を使って認証を行ないます。

電話番号などを登録する原稿の2要素認証は手間がかかることが多いですが、
U2Fでは公開鍵暗号を利用した


2要素目のキーとして用いている
デバイスから公開鍵と秘密鍵のペアを生成し、その公開鍵を事前にサーバに登
録する方式をとっている。認証の際には USB キーから生成した秘密鍵でサイ
ンした情報を、サーバに事前登録された鍵と照合して認証する。


USBメモリなどの第2要素による認証を追加した2段階認証です。

の略であり、こちらは現在の2要素認証

UAFが普及するまで一時的に利用することを考えたもので、
パスワード認証を利用する現状サービスの上に使いやすい2段階認証を導入したものです。
http://app-review.jp/news/230600

Universal Second Factorの略称。既存の認証方式を導入しているWebサービス
などが、二段階認証（英語版）を導入する際に用いる方式[10]。
利用者は、従来通りのアカウントIDとパスワードによる認証後、U2Fに対応したUSB端末や
NFC端末を使う事でログインが可能になる[10][11]。

</ul>

<!--
一方 U2F だが、Google の Dirk Balfanz 氏によれば、


これは要するに、Googleアカウントで言えば、ID（Gmailアドレス）＆パスワー
ドの他に電話番号も登録し、Google 管理コンソールから有効にすれば利用す
ることができる2段階認証を改善したようなものである。現状の2要素認証は、
ユーザー側から見れば非常に手間のかかる、面倒くさい方式であり、Google
の Sam Srinivas 氏によれば2段階認証を利用しているユーザーはあまり多く
ないという。また、ワンタイムパスワードを生成するような機器は壊れやすかっ
たり、高価であるという問題もある。

そこで、FIDO では、安価に作れる USB メモリのようなデバイスを挿すだけで
できるような、UX（ユーザーエクスペリエンス）を改善した2要素認証として
U2F を提案している。また、この U2F では、2要素目のキーとして用いている
デバイスから公開鍵と秘密鍵のペアを生成し、その公開鍵を事前にサーバに登
録する方式をとっている。認証の際には USB キーから生成した秘密鍵でサイ
ンした情報を、サーバに事前登録された鍵と照合して認証する。

このため、悪意を持った偽のサーバにアクセスしてしまったとしても、偽のサー
バがそこから認証のキーを得て本来のサーバにアクセスすることはできない仕
組みだ。接続先のサイトに登録した認証デバイス（オーセンティケータ）と認
証要素が揃って初めて認証できる仕組みであることから、フィッシングや「な
りすまし」対策が可能となる。
-->

FIDO を実現する認証方式を2つ開発した理由については、現在の認証を全て
UAF へ移行するまでの間、一部の認証を U2F で行う必要があるからだということです。

2要素目のキーとして用いているデバイスから公開鍵と秘密鍵のペアを生成し、
その公開鍵を事前にサーバに登録する方式をとっている

<h2>IoT時代の認証の今後</h2>

プライバシ、認証、などをうまく組み合わせた設計が必要になるのだろう

FIDOが標準になるかはわかりませんが、
IoT技術をうまく利用した認証手法が将来広く使われるようになることは間違いないでしょう。


手の中にRFIDを埋め込んで認証を行なうという恐い話が
<a href="http://fundo.jp/20664">話題になっていました</a>。

<!--
”エピセンター”というスウェーデンの複合オフィスでは、マイクロチップを
社員の手に埋め込むという試みが、実際に行われています。手をかざすだけで
携帯電話のロック解除や、オフィスへの入室が可能に。まるでSF映画みたいで
す。
更新日: 2015年09月17日
http://matome.naver.jp/odai/2142378307666546901

http://karapaia.livedoor.biz/archives/52184120.html

カスペルスキー? スウェーデン??
http://blog.livedoor.jp/itsoku/archives/46175853.html
-->

<blockquote>
<img src="https://gyazo.com/8632086ca5ed8281be55a178e1a342b6.png">
</blockquote>

指に埋め込むのは嫌でしょうが、
いつも持ち歩いているスマホで認証を行なったり
生体認証を行なったりするのであれば
そう変わらないともいえるでしょう。

プライバシが漏れまくる地獄になるのか、
認証がほとんど不要になる天国になるのか
頑張りが必要なのでしょう。

<!-- 今後FIDOは重要な認証方法のひとつとなるでしょう。-->

<!-- http://cloud.watch.impress.co.jp/docs/interview/20150813_716045.html -->


<ul>
<li> [1] Joseph Bonneau, Cormac Herley, Paul C. van Oorschot and Frank Stajano.
The Quest to Replace Passwords: A Framework for Comparative Evaluation of Web Authentication Schemes.
Proceedings of the 2012 IEEE Symposium on Security and Privacy, pp. 553-567, 2012.
</ul>

</div>
</body>
</html>

